<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="H·ªá th·ªëng gi√°m s√°t ch·∫•t l∆∞·ª£ng kh√¥ng kh√≠ th·ªùi gian th·ª±c t·ª´ c·∫£m bi·∫øn ESP32 t·∫°i VNU">
    <meta name="theme-color" content="#1e3a8a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <title>Air Quality Monitor - VNU IS</title>
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75'>üí®</text></svg>">
</head>
<body>
    <!-- Navigation Taskbar -->
    <nav class="taskbar">
        <div class="nav-brand">
            <i class="fas fa-wind"></i>
            <span>AQI Monitor</span>
        </div>
        <ul class="nav-menu">
            <li><a href="#" class="nav-link active" data-page="dashboard"><i class="fas fa-home"></i> Dashboard</a></li>
            <li><a href="#" class="nav-link" data-page="map"><i class="fas fa-map-marked-alt"></i> B·∫£n ƒê·ªì</a></li>
            <li><a href="#" class="nav-link" data-page="charts"><i class="fas fa-chart-line"></i> Bi·ªÉu ƒê·ªì</a></li>
            <li><a href="#" class="nav-link" data-page="settings"><i class="fas fa-cog"></i> C√†i ƒê·∫∑t</a></li>
        </ul>
        <div class="nav-status">
            <span class="status-dot" id="nav-status-dot"></span>
            <span id="nav-connection-text">ƒêang k·∫øt n·ªëi...</span>
        </div>
    </nav>

    <div class="container">
        <!-- Dashboard Page -->
        <div class="page active" id="dashboard-page">
            <div class="page-header">
                <div class="header-content">
                    <div>
                        <h1><i class="fas fa-tachometer-alt"></i> Dashboard Gi√°m S√°t</h1>
                        <p class="subtitle">üåç VNU IS - S·ªë 1 Tr·ªãnh VƒÉn B√¥, H√† N·ªôi</p>
                    </div>
                    <div class="header-stats">
                        <div class="stat-pill">
                            <i class="fas fa-cloud"></i>
                            <span id="weather-status">ƒêang c·∫≠p nh·∫≠t...</span>
                        </div>
                        <div class="stat-pill aqi-pill" id="header-aqi-pill">
                            <i class="fas fa-wind"></i>
                            <span>AQI: <strong id="header-aqi">--</strong></span>
                        </div>
                    </div>
                </div>
            </div>

        <!-- Status Bar -->
        <div class="status-bar" role="status" aria-live="polite">
            <div class="status-item">
                <i class="fas fa-circle" id="connection-status" aria-label="Tr·∫°ng th√°i k·∫øt n·ªëi"></i>
                <span id="connection-text">ƒêang k·∫øt n·ªëi...</span>
            </div>
            <div class="status-item">
                <i class="fas fa-clock"></i>
                <span id="last-update">Ch∆∞a c√≥ d·ªØ li·ªáu</span>
            </div>
            <div class="status-item alert-indicator" id="alert-indicator">
                <i class="fas fa-bell"></i>
                <span id="alert-count">0 c·∫£nh b√°o</span>
            </div>
            <div class="status-item">
                <i class="fas fa-database"></i>
                <span id="db-status">Firebase: Ch∆∞a k·∫øt n·ªëi</span>
            </div>
        </div>

        <!-- Active Alerts Banner -->
        <div class="alerts-banner" id="alerts-banner" style="display: none;" role="alert">
            <div class="alert-content">
                <i class="fas fa-exclamation-triangle"></i>
                <span id="alert-message"></span>
            </div>
            <button class="alert-close" onclick="closeAlertBanner()" aria-label="ƒê√≥ng c·∫£nh b√°o">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Sensor Data Cards -->
        <section aria-label="D·ªØ li·ªáu c·∫£m bi·∫øn">
            <div class="cards-container">
                <!-- Temperature Card -->
                <article class="card temperature" role="region" aria-label="D·ªØ li·ªáu nhi·ªát ƒë·ªô">
                    <div class="card-icon">
                        <i class="fas fa-temperature-high"></i>
                    </div>
                    <div class="card-content">
                        <h3>Nhi·ªát ƒê·ªô</h3>
                        <div class="value" id="temperature" aria-live="polite">--</div>
                        <div class="unit">¬∞C</div>
                    </div>
                    <div class="card-status" id="temp-status">ƒêang ƒë·ªçc...</div>
                </article>

                <!-- Humidity Card -->
                <article class="card humidity" role="region" aria-label="D·ªØ li·ªáu ƒë·ªô ·∫©m">
                    <div class="card-icon">
                        <i class="fas fa-tint"></i>
                    </div>
                    <div class="card-content">
                        <h3>ƒê·ªô ·∫®m</h3>
                        <div class="value" id="humidity" aria-live="polite">--</div>
                        <div class="unit">%</div>
                    </div>
                    <div class="card-status" id="humidity-status">ƒêang ƒë·ªçc...</div>
                </article>

                <!-- CO Card -->
                <article class="card co" role="region" aria-label="D·ªØ li·ªáu kh√≠ CO">
                    <div class="card-icon">
                        <i class="fas fa-smog"></i>
                    </div>
                    <div class="card-content">
                        <h3>Kh√≠ CO</h3>
                        <div class="value" id="co" aria-live="polite">--</div>
                        <div class="unit">ppm</div>
                    </div>
                    <div class="card-status" id="co-status">ƒêang ƒë·ªçc...</div>
                </article>

                <!-- PM2.5 Card -->
                <article class="card pm25" role="region" aria-label="D·ªØ li·ªáu b·ª•i PM2.5">
                    <div class="card-icon">
                        <i class="fas fa-lungs"></i>
                    </div>
                    <div class="card-content">
                        <h3>B·ª•i PM2.5</h3>
                        <div class="value" id="pm25" aria-live="polite">--</div>
                        <div class="unit">Œºg/m¬≥</div>
                    </div>
                    <div class="card-status" id="pm25-status">ƒêang ƒë·ªçc...</div>
                </article>
            </div>
        </section>

        <!-- Fan Control Section - Modern Design -->
        <section class="fan-section" aria-label="ƒêi·ªÅu khi·ªÉn qu·∫°t l·ªçc gi√≥">
            <div class="fan-control-modern">
                <div class="fan-header-bar">
                    <div class="fan-title">
                        <i class="fas fa-fan fa-spin" id="fan-icon" style="animation-play-state: paused;"></i>
                        <div>
                            <h2>Qu·∫°t L·ªçc Kh√¥ng Kh√≠</h2>
                            <p class="fan-subtitle">ƒêi·ªÅu khi·ªÉn th√¥ng minh t·ª± ƒë·ªông</p>
                        </div>
                    </div>
                    <div class="fan-status-badge" id="fan-status-badge">
                        <span class="status-indicator"></span>
                        <span id="fan-status-text">T·∫ÆT</span>
                    </div>
                </div>

                <div class="fan-control-grid">
                    <!-- Fan Speed Control -->
                    <div class="fan-control-card">
                        <div class="control-header">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>T·ªëc ƒê·ªô Qu·∫°t</span>
                        </div>
                        <div class="speed-display">
                            <div class="speed-circle">
                                <svg class="speed-ring" viewBox="0 0 120 120">
                                    <circle class="speed-ring-bg" cx="60" cy="60" r="50"></circle>
                                    <circle class="speed-ring-progress" id="speed-ring-progress" cx="60" cy="60" r="50"></circle>
                                </svg>
                                <div class="speed-text">
                                    <span id="fan-speed-display">0</span>
                                    <small>%</small>
                                </div>
                            </div>
                        </div>
                        <input type="range" id="fan-speed" min="0" max="100" value="0" 
                               class="modern-slider" oninput="updateFanSpeed(this.value)">
                        <div class="speed-labels">
                            <span>0%</span>
                            <span>50%</span>
                            <span>100%</span>
                        </div>
                    </div>

                    <!-- Fan Mode Control -->
                    <div class="fan-control-card">
                        <div class="control-header">
                            <i class="fas fa-cogs"></i>
                            <span>Ch·∫ø ƒê·ªô Ho·∫°t ƒê·ªông</span>
                        </div>
                        <div class="mode-buttons">
                            <button class="mode-btn" id="btn-manual" onclick="setFanMode('manual')" 
                                    title="ƒêi·ªÅu khi·ªÉn qu·∫°t th·ªß c√¥ng b·∫±ng tay">
                                <i class="fas fa-hand-paper"></i>
                                <span>Th·ªß C√¥ng</span>
                            </button>
                            <button class="mode-btn active" id="btn-auto" onclick="setFanMode('auto')"
                                    title="Qu·∫°t t·ª± ƒë·ªông b·∫≠t/t·∫Øt theo ng∆∞·ª°ng">
                                <i class="fas fa-magic"></i>
                                <span>T·ª± ƒê·ªông</span>
                            </button>
                        </div>
                        <div class="auto-info" id="auto-info">
                            <i class="fas fa-info-circle"></i>
                            <p>Qu·∫°t s·∫Ω t·ª± ƒë·ªông b·∫≠t khi CO > <strong id="co-threshold-display">200</strong> ppm ho·∫∑c PM2.5 > <strong id="pm25-threshold-display">55</strong> Œºg/m¬≥</p>
                        </div>
                    </div>

                    <!-- Fan Power Control -->
                    <div class="fan-control-card">
                        <div class="control-header">
                            <i class="fas fa-power-off"></i>
                            <span>Ngu·ªìn ƒêi·ªán</span>
                        </div>
                        <div class="power-control">
                            <button class="power-btn" id="power-btn" onclick="toggleFan()">
                                <i class="fas fa-power-off"></i>
                            </button>
                            <p class="power-label" id="power-label">Nh·∫•n ƒë·ªÉ b·∫≠t</p>
                        </div>
                        <div class="fan-stats">
                            <div class="stat-item">
                                <i class="fas fa-clock"></i>
                                <div>
                                    <small>Th·ªùi gian ho·∫°t ƒë·ªông</small>
                                    <strong id="fan-runtime">0h 0m</strong>
                                </div>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-history"></i>
                                <div>
                                    <small>L·∫ßn b·∫≠t cu·ªëi</small>
                                    <strong id="fan-last-on">Ch∆∞a c√≥</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Air Quality Index -->
        <section class="aqi-container" aria-label="Ch·ªâ s·ªë ch·∫•t l∆∞·ª£ng kh√¥ng kh√≠">
            <h2><i class="fas fa-chart-pie"></i> Ch·ªâ S·ªë Ch·∫•t L∆∞·ª£ng Kh√¥ng Kh√≠ (AQI)</h2>
            <div class="aqi-display">
                <div class="aqi-circle-container">
                    <div class="aqi-value" id="aqi-value" aria-live="polite">--</div>
                </div>
                <div class="aqi-info">
                    <div class="aqi-label" id="aqi-label">ƒêang t√≠nh to√°n...</div>
                    <div class="aqi-description" id="aqi-description">
                        Ch·ªù d·ªØ li·ªáu t·ª´ c·∫£m bi·∫øn...
                    </div>
                </div>
            </div>
        </section>

        <!-- Tabs Navigation -->
        <div class="tabs-container">
            <nav class="tabs-nav" role="tablist">
                <button class="tab-btn active" data-tab="chart" role="tab" aria-selected="true" aria-controls="chart-tab">
                    <i class="fas fa-chart-line"></i> Bi·ªÉu ƒê·ªì
                </button>
                <button class="tab-btn" data-tab="settings" role="tab" aria-selected="false" aria-controls="settings-tab">
                    <i class="fas fa-cog"></i> C√†i ƒê·∫∑t Ng∆∞·ª°ng
                </button>
                <button class="tab-btn" data-tab="history" role="tab" aria-selected="false" aria-controls="history-tab">
                    <i class="fas fa-history"></i> L·ªãch S·ª≠ C·∫£nh B√°o
                </button>
                <button class="tab-btn" data-tab="about" role="tab" aria-selected="false" aria-controls="about-tab">
                    <i class="fas fa-info-circle"></i> V·ªÅ H·ªá Th·ªëng
                </button>
            </nav>

            <!-- Chart Tab -->
            <div class="tab-content active" id="chart-tab" role="tabpanel">
                <div class="chart-header">
                    <h3><i class="fas fa-chart-area"></i> Bi·ªÉu ƒê·ªì D·ªØ Li·ªáu Th·ªùi Gian Th·ª±c</h3>
                    <p>Hi·ªÉn th·ªã 20 ƒëi·ªÉm d·ªØ li·ªáu g·∫ßn nh·∫•t</p>
                </div>
                <div class="chart-loading" id="chart-loading" style="display: none;">
                    <i class="fas fa-spinner fa-spin"></i> ƒêang t·∫£i bi·ªÉu ƒë·ªì...
                </div>
                <div class="chart-wrapper">
                    <canvas id="dataChart"></canvas>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-content" id="settings-tab" role="tabpanel">
                <div class="settings-grid">
                    <!-- Temperature Threshold -->
                    <div class="setting-card">
                        <div class="setting-header">
                            <i class="fas fa-temperature-high"></i>
                            <h3>Ng∆∞·ª°ng Nhi·ªát ƒê·ªô</h3>
                        </div>
                        <div class="setting-inputs">
                            <div class="input-group">
                                <label for="temp-min">T·ªëi thi·ªÉu (¬∞C)</label>
                                <input type="number" id="temp-min" value="18" step="0.5" min="-10" max="50">
                            </div>
                            <div class="input-group">
                                <label for="temp-max">T·ªëi ƒëa (¬∞C)</label>
                                <input type="number" id="temp-max" value="35" step="0.5" min="-10" max="50">
                            </div>
                        </div>
                        <div class="setting-toggle">
                            <label class="switch">
                                <input type="checkbox" id="temp-alert-enabled" checked>
                                <span class="slider"></span>
                            </label>
                            <span>B·∫≠t c·∫£nh b√°o</span>
                        </div>
                    </div>

                    <!-- Humidity Threshold -->
                    <div class="setting-card">
                        <div class="setting-header">
                            <i class="fas fa-tint"></i>
                            <h3>Ng∆∞·ª°ng ƒê·ªô ·∫®m</h3>
                        </div>
                        <div class="setting-inputs">
                            <div class="input-group">
                                <label for="humidity-min">T·ªëi thi·ªÉu (%)</label>
                                <input type="number" id="humidity-min" value="30" step="1" min="0" max="100">
                            </div>
                            <div class="input-group">
                                <label for="humidity-max">T·ªëi ƒëa (%)</label>
                                <input type="number" id="humidity-max" value="80" step="1" min="0" max="100">
                            </div>
                        </div>
                        <div class="setting-toggle">
                            <label class="switch">
                                <input type="checkbox" id="humidity-alert-enabled" checked>
                                <span class="slider"></span>
                            </label>
                            <span>B·∫≠t c·∫£nh b√°o</span>
                        </div>
                    </div>

                    <!-- CO Threshold -->
                    <div class="setting-card">
                        <div class="setting-header">
                            <i class="fas fa-smog"></i>
                            <h3>Ng∆∞·ª°ng Kh√≠ CO</h3>
                        </div>
                        <div class="setting-inputs">
                            <div class="input-group">
                                <label for="co-max">T·ªëi ƒëa (ppm)</label>
                                <input type="number" id="co-max" value="200" step="10" min="0" max="2000">
                            </div>
                        </div>
                        <div class="setting-toggle">
                            <label class="switch">
                                <input type="checkbox" id="co-alert-enabled" checked>
                                <span class="slider"></span>
                            </label>
                            <span>B·∫≠t c·∫£nh b√°o</span>
                        </div>
                    </div>

                    <!-- PM2.5 Threshold -->
                    <div class="setting-card">
                        <div class="setting-header">
                            <i class="fas fa-lungs"></i>
                            <h3>Ng∆∞·ª°ng B·ª•i PM2.5</h3>
                        </div>
                        <div class="setting-inputs">
                            <div class="input-group">
                                <label for="pm25-max">T·ªëi ƒëa (Œºg/m¬≥)</label>
                                <input type="number" id="pm25-max" value="55" step="1" min="0" max="500">
                            </div>
                        </div>
                        <div class="setting-toggle">
                            <label class="switch">
                                <input type="checkbox" id="pm25-alert-enabled" checked>
                                <span class="slider"></span>
                            </label>
                            <span>B·∫≠t c·∫£nh b√°o</span>
                        </div>
                    </div>
                </div>
                <div class="settings-actions">
                    <button class="btn-save" onclick="saveThresholds()" title="L∆∞u l·∫°i c√°c c√†i ƒë·∫∑t">
                        <i class="fas fa-save"></i> L∆∞u C√†i ƒê·∫∑t
                    </button>
                    <button class="btn-reset" onclick="resetThresholds()" title="ƒê·∫∑t l·∫°i c√°c gi√° tr·ªã m·∫∑c ƒë·ªãnh">
                        <i class="fas fa-undo"></i> ƒê·∫∑t L·∫°i M·∫∑c ƒê·ªãnh
                    </button>
                </div>
            </div>

            <!-- History Tab -->
            <div class="tab-content" id="history-tab" role="tabpanel">
                <div class="history-controls">
                    <button class="btn-clear" onclick="clearAlertHistory()" title="X√≥a to√†n b·ªô l·ªãch s·ª≠ c·∫£nh b√°o">
                        <i class="fas fa-trash"></i> X√≥a L·ªãch S·ª≠
                    </button>
                    <button class="btn-export" onclick="exportAlertHistory()" title="T·∫£i xu·ªëng file CSV">
                        <i class="fas fa-download"></i> Xu·∫•t File
                    </button>
                </div>
                <div class="history-list" id="history-list">
                    <div class="no-history">
                        <i class="fas fa-inbox"></i>
                        <p>Ch∆∞a c√≥ c·∫£nh b√°o n√†o</p>
                    </div>
                </div>
            </div>

            <!-- About Tab -->
            <div class="tab-content" id="about-tab" role="tabpanel">
                <div class="about-content">
                    <div class="about-section">
                        <h3><i class="fas fa-graduation-cap"></i> V·ªÅ D·ª± √Ån</h3>
                        <p>H·ªá th·ªëng gi√°m s√°t ch·∫•t l∆∞·ª£ng kh√¥ng kh√≠ th·ªùi gian th·ª±c ƒë∆∞·ª£c ph√°t tri·ªÉn b·ªüi sinh vi√™n VNU IS nh·∫±m:</p>
                        <ul>
                            <li>Gi√°m s√°t ch·∫•t l∆∞·ª£ng kh√¥ng kh√≠ trong m√¥i tr∆∞·ªùng</li>
                            <li>C·∫£nh b√°o khi c√°c ch·ªâ s·ªë v∆∞·ª£t ng∆∞·ª°ng cho ph√©p</li>
                            <li>L∆∞u tr·ªØ d·ªØ li·ªáu l·ªãch s·ª≠ v√† ph√¢n t√≠ch xu h∆∞·ªõng</li>
                            <li>ƒêi·ªÅu khi·ªÉn qu·∫°t l·ªçc gi√≥ t·ª± ƒë·ªông ho·∫∑c th·ªß c√¥ng</li>
                        </ul>
                    </div>

                    <div class="about-section">
                        <h3><i class="fas fa-microchip"></i> Thi·∫øt B·ªã & C√¥ng Ngh·ªá</h3>
                        <div class="tech-grid">
                            <div class="tech-item">
                                <span class="tech-icon">üîß</span>
                                <strong>C·∫£m Bi·∫øn:</strong> ESP32 + DHT22, MQ-7, PM2.5
                            </div>
                            <div class="tech-item">
                                <span class="tech-icon">‚òÅÔ∏è</span>
                                <strong>Backend:</strong> Firebase Realtime Database
                            </div>
                            <div class="tech-item">
                                <span class="tech-icon">üé®</span>
                                <strong>Frontend:</strong> HTML5, CSS3, JavaScript
                            </div>
                            <div class="tech-item">
                                <span class="tech-icon">üìä</span>
                                <strong>Bi·ªÉu ƒê·ªì:</strong> Chart.js
                            </div>
                        </div>
                    </div>

                    <div class="about-section">
                        <h3><i class="fas fa-info-circle"></i> Th√¥ng Tin C·∫£m Bi·∫øn</h3>
                        <table class="info-table">
                            <thead>
                                <tr>
                                    <th>T√™n C·∫£m Bi·∫øn</th>
                                    <th>Lo·∫°i D·ªØ Li·ªáu</th>
                                    <th>Ph·∫°m Vi</th>
                                    <th>ƒê∆°n V·ªã</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>DHT22</td>
                                    <td>Nhi·ªát ƒë·ªô, ƒê·ªô ·∫©m</td>
                                    <td>-40 ƒë·∫øn 80¬∞C</td>
                                    <td>¬∞C, %</td>
                                </tr>
                                <tr>
                                    <td>MQ-7</td>
                                    <td>Kh√≠ CO</td>
                                    <td>20 - 2000</td>
                                    <td>ppm</td>
                                </tr>
                                <tr>
                                    <td>PM2.5</td>
                                    <td>B·ª•i m·ªãn</td>
                                    <td>0 - 999.9</td>
                                    <td>Œºg/m¬≥</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="about-section">
                        <h3><i class="fas fa-envelope"></i> Li√™n H·ªá</h3>
                        <p>Ph√≤ng Khoa h·ªçc & C√¥ng ngh·ªá, VNU - ƒê·∫°i h·ªçc Qu·ªëc gia H√† N·ªôi</p>
                        <p>Email: support@vnu-airquality.edu.vn</p>
                    </div>
                </div>
            </div>
        </div>

        </div>

        <!-- Map Page -->
        <div class="page" id="map-page">
            <div class="page-header">
                <h1><i class="fas fa-map-marked-alt"></i> V·ªã Tr√≠ Tr·∫°m Gi√°m S√°t</h1>
                <p class="subtitle">VNU IS - S·ªë 1 Tr·ªãnh VƒÉn B√¥, Nam T·ª´ Li√™m, H√† N·ªôi</p>
            </div>
            <div class="location-info">
                <div class="info-item">
                    <i class="fas fa-map-pin"></i>
                    <span><strong>T·ªça ƒë·ªô:</strong> 21.0370717¬∞ N, 105.7487065¬∞ E</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-building"></i>
                    <span><strong>ƒê·ªãa ch·ªâ:</strong> Tr∆∞·ªùng ƒê·∫°i h·ªçc Khoa h·ªçc T·ª± nhi√™n, VNU IS</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-city"></i>
                    <span><strong>Khu v·ª±c:</strong> S·ªë 1 Tr·ªãnh VƒÉn B√¥, Nam T·ª´ Li√™m, H√† N·ªôi</span>
                </div>
            </div>
            <div id="map-container" style="height: 500px; width: 100%; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 16px rgba(0,0,0,0.1);"></div>
        </div>

        <!-- Charts Page -->
        <div class="page" id="charts-page">
            <div class="page-header">
                <h1><i class="fas fa-chart-line"></i> Bi·ªÉu ƒê·ªì D·ªØ Li·ªáu</h1>
                <p class="subtitle">Ph√¢n t√≠ch xu h∆∞·ªõng d·ªØ li·ªáu th·ªùi gian th·ª±c</p>
            </div>
            <div class="charts-grid">
                <div class="chart-card">
                    <h3><i class="fas fa-temperature-high"></i> Nhi·ªát ƒê·ªô & ƒê·ªô ·∫®m</h3>
                    <canvas id="tempHumidChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3><i class="fas fa-smog"></i> Ch·∫•t L∆∞·ª£ng Kh√¥ng Kh√≠</h3>
                    <canvas id="airQualityChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div class="page" id="settings-page">
            <div class="page-header">
                <h1><i class="fas fa-cog"></i> C√†i ƒê·∫∑t H·ªá Th·ªëng</h1>
                <p class="subtitle">T√πy ch·ªânh ng∆∞·ª°ng c·∫£nh b√°o v√† th√¥ng b√°o</p>
            </div>
            <div class="settings-grid">
                <!-- Temperature Threshold -->
                <div class="setting-card">
                    <div class="setting-header">
                        <i class="fas fa-temperature-high"></i>
                        <h3>Ng∆∞·ª°ng Nhi·ªát ƒê·ªô</h3>
                    </div>
                    <div class="setting-inputs">
                        <div class="input-group">
                            <label for="temp-min-2">T·ªëi thi·ªÉu (¬∞C)</label>
                            <input type="number" id="temp-min-2" value="18" step="0.5" min="-10" max="50">
                        </div>
                        <div class="input-group">
                            <label for="temp-max-2">T·ªëi ƒëa (¬∞C)</label>
                            <input type="number" id="temp-max-2" value="35" step="0.5" min="-10" max="50">
                        </div>
                    </div>
                    <div class="setting-toggle">
                        <label class="switch">
                            <input type="checkbox" id="temp-alert-enabled-2" checked>
                            <span class="slider"></span>
                        </label>
                        <span>B·∫≠t c·∫£nh b√°o</span>
                    </div>
                </div>

                <!-- Humidity Threshold -->
                <div class="setting-card">
                    <div class="setting-header">
                        <i class="fas fa-tint"></i>
                        <h3>Ng∆∞·ª°ng ƒê·ªô ·∫®m</h3>
                    </div>
                    <div class="setting-inputs">
                        <div class="input-group">
                            <label for="humidity-min-2">T·ªëi thi·ªÉu (%)</label>
                            <input type="number" id="humidity-min-2" value="30" step="1" min="0" max="100">
                        </div>
                        <div class="input-group">
                            <label for="humidity-max-2">T·ªëi ƒëa (%)</label>
                            <input type="number" id="humidity-max-2" value="80" step="1" min="0" max="100">
                        </div>
                    </div>
                    <div class="setting-toggle">
                        <label class="switch">
                            <input type="checkbox" id="humidity-alert-enabled-2" checked>
                            <span class="slider"></span>
                        </label>
                        <span>B·∫≠t c·∫£nh b√°o</span>
                    </div>
                </div>

                <!-- CO Threshold -->
                <div class="setting-card">
                    <div class="setting-header">
                        <i class="fas fa-smog"></i>
                        <h3>Ng∆∞·ª°ng Kh√≠ CO</h3>
                    </div>
                    <div class="setting-inputs">
                        <div class="input-group">
                            <label for="co-max-2">T·ªëi ƒëa (ppm)</label>
                            <input type="number" id="co-max-2" value="200" step="10" min="0" max="2000">
                        </div>
                    </div>
                    <div class="setting-toggle">
                        <label class="switch">
                            <input type="checkbox" id="co-alert-enabled-2" checked>
                            <span class="slider"></span>
                        </label>
                        <span>B·∫≠t c·∫£nh b√°o</span>
                    </div>
                </div>

                <!-- PM2.5 Threshold -->
                <div class="setting-card">
                    <div class="setting-header">
                        <i class="fas fa-lungs"></i>
                        <h3>Ng∆∞·ª°ng B·ª•i PM2.5</h3>
                    </div>
                    <div class="setting-inputs">
                        <div class="input-group">
                            <label for="pm25-max-2">T·ªëi ƒëa (Œºg/m¬≥)</label>
                            <input type="number" id="pm25-max-2" value="55" step="1" min="0" max="500">
                        </div>
                    </div>
                    <div class="setting-toggle">
                        <label class="switch">
                            <input type="checkbox" id="pm25-alert-enabled-2" checked>
                            <span class="slider"></span>
                        </label>
                        <span>B·∫≠t c·∫£nh b√°o</span>
                    </div>
                </div>
            </div>
            <div class="settings-actions">
                <button class="btn-save" onclick="saveThresholds()" title="L∆∞u l·∫°i c√°c c√†i ƒë·∫∑t">
                    <i class="fas fa-save"></i> L∆∞u C√†i ƒê·∫∑t
                </button>
                <button class="btn-reset" onclick="resetThresholds()" title="ƒê·∫∑t l·∫°i c√°c gi√° tr·ªã m·∫∑c ƒë·ªãnh">
                    <i class="fas fa-undo"></i> ƒê·∫∑t L·∫°i M·∫∑c ƒê·ªãnh
                </button>
            </div>
        </div>

        <!-- Footer -->
        <footer role="contentinfo">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-university"></i> VNU IS</h4>
                    <p>Tr∆∞·ªùng ƒê·∫°i h·ªçc Khoa h·ªçc T·ª± nhi√™n</p>
                    <p>üìç S·ªë 1 Tr·ªãnh VƒÉn B√¥, Nam T·ª´ Li√™m, H√† N·ªôi</p>
                </div>
                <div class="footer-section">
                    <h4><i class="fas fa-microchip"></i> C√¥ng Ngh·ªá</h4>
                    <p>üîß ESP32 + Sensors (DHT22, MQ-7, PM2.5)</p>
                    <p>‚òÅÔ∏è Firebase Realtime Database</p>
                </div>
                <div class="footer-section">
                    <h4><i class="fas fa-info-circle"></i> Phi√™n B·∫£n</h4>
                    <p>Version 2.5 - Professional Edition</p>
                    <p>¬© 2025 Air Quality Monitoring System</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>Developed with <i class="fas fa-heart" style="color: #ef4444;"></i> by VNU Students</p>
            </div>
        </footer>
    </div>

    <!-- Alert Popup Modal -->
    <div class="alert-popup" id="alert-popup">
        <div class="alert-popup-content">
            <div class="alert-popup-header">
                <i class="fas fa-exclamation-triangle"></i>
                <h2>C·∫£nh B√°o Ng∆∞·ª°ng</h2>
            </div>
            <div class="alert-popup-body" id="alert-popup-body">
                <!-- Alert content will be dynamically inserted -->
            </div>
            <div class="alert-popup-footer">
                <button class="btn-popup-close" onclick="closeAlertPopup()">
                    <i class="fas fa-times"></i> ƒê√≥ng
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
        </div>
    </div>

    <!-- Scroll to Top Button -->
    <button class="scroll-top" id="scroll-top" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- App Scripts -->
    <script type="module" src="app.js"></script>
    
    <script>
        // Hide loading overlay after page loads
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('loading-overlay').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loading-overlay').style.display = 'none';
                }, 300);
            }, 800);
        });
        
        // Scroll to top functionality
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
        
        // Show/hide scroll to top button
        window.addEventListener('scroll', function() {
            const scrollTop = document.getElementById('scroll-top');
            if (window.pageYOffset > 300) {
                scrollTop.classList.add('show');
            } else {
                scrollTop.classList.remove('show');
            }
        });
        
        // Add fade-in animation to cards on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);
        
        // Observe all cards and sections
        setTimeout(() => {
            document.querySelectorAll('.card, .fan-control-modern, .aqi-container').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                observer.observe(el);
            });
        }, 1000);
    </script>
</body>
</html>
